{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport api from '../../api';\nimport history from '../../history';\nexport default function useAuth() {\n  const [authenticated, setAuthenticated] = useState(false);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`;\n      setAuthenticated(true);\n    }\n\n    setLoading(false);\n  }, []);\n\n  async function handleLogin(dados) {\n    const userName = dados.login;\n    const password = dados.password;\n    const response = \"\";\n\n    try {\n      const response = await api.post('/users/login', {\n        userName,\n        password\n      });\n      const nome = response.data.name;\n      localStorage.setItem('name', JSON.stringify(response.data.name));\n      localStorage.setItem('id', JSON.stringify(response.data.id)); // api.defaults.headers.Authorization = `Bearer ${token}`;\n\n      alert(localStorage.getItem('id'));\n      setAuthenticated(true);\n      history.push({\n        pathname: '/Users',\n        state: nome\n      });\n    } catch (err) {\n      alert(\"Erro no login! verifique seus dados \");\n    }\n  }\n\n  function handleLogout() {\n    setAuthenticated(false);\n    localStorage.removeItem('token');\n    api.defaults.headers.Authorization = undefined;\n    history.push('/login');\n  }\n\n  return {\n    authenticated,\n    loading,\n    handleLogin,\n    handleLogout\n  };\n}","map":{"version":3,"sources":["C:/Users/T-Gamer/Desktop/final/src/Context/hooks/useAuth.js"],"names":["useState","useEffect","api","history","useAuth","authenticated","setAuthenticated","loading","setLoading","token","localStorage","getItem","defaults","headers","Authorization","JSON","parse","handleLogin","dados","userName","login","password","response","post","nome","data","name","setItem","stringify","id","alert","push","pathname","state","err","handleLogout","removeItem","undefined"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AAEA,OAAOC,GAAP,MAAgB,WAAhB;AACA,OAAOC,OAAP,MAAoB,eAApB;AAEA,eAAe,SAASC,OAAT,GAAmB;AAChC,QAAM,CAACC,aAAD,EAAgBC,gBAAhB,IAAoCN,QAAQ,CAAC,KAAD,CAAlD;AACA,QAAM,CAACO,OAAD,EAAUC,UAAV,IAAwBR,QAAQ,CAAC,IAAD,CAAtC;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMQ,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;AAEA,QAAIF,KAAJ,EAAW;AACTP,MAAAA,GAAG,CAACU,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAsC,UAASC,IAAI,CAACC,KAAL,CAAWP,KAAX,CAAkB,EAAjE;AACAH,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD;;AAEDE,IAAAA,UAAU,CAAC,KAAD,CAAV;AACD,GATQ,EASN,EATM,CAAT;;AAWA,iBAAeS,WAAf,CAA2BC,KAA3B,EAAkC;AAEhC,UAAMC,QAAQ,GAAGD,KAAK,CAACE,KAAvB;AACA,UAAMC,QAAQ,GAAGH,KAAK,CAACG,QAAvB;AACA,UAAMC,QAAQ,GAAG,EAAjB;;AAEA,QAAI;AACF,YAAMA,QAAQ,GAAG,MAAMpB,GAAG,CAACqB,IAAJ,CAAS,cAAT,EAAyB;AAAEJ,QAAAA,QAAF;AAAYE,QAAAA;AAAZ,OAAzB,CAAvB;AAEA,YAAMG,IAAI,GAAGF,QAAQ,CAACG,IAAT,CAAcC,IAA3B;AAEAhB,MAAAA,YAAY,CAACiB,OAAb,CAAqB,MAArB,EAA6BZ,IAAI,CAACa,SAAL,CAAeN,QAAQ,CAACG,IAAT,CAAcC,IAA7B,CAA7B;AACAhB,MAAAA,YAAY,CAACiB,OAAb,CAAqB,IAArB,EAA2BZ,IAAI,CAACa,SAAL,CAAeN,QAAQ,CAACG,IAAT,CAAcI,EAA7B,CAA3B,EANE,CAOF;;AAEAC,MAAAA,KAAK,CAACpB,YAAY,CAACC,OAAb,CAAqB,IAArB,CAAD,CAAL;AAEAL,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACAH,MAAAA,OAAO,CAAC4B,IAAR,CAAa;AACXC,QAAAA,QAAQ,EAAE,QADC;AAEXC,QAAAA,KAAK,EAAET;AAFI,OAAb;AAID,KAhBD,CAgBE,OAAOU,GAAP,EAAY;AACZJ,MAAAA,KAAK,CAAC,sCAAD,CAAL;AACD;AAEF;;AAED,WAASK,YAAT,GAAwB;AACtB7B,IAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACAI,IAAAA,YAAY,CAAC0B,UAAb,CAAwB,OAAxB;AACAlC,IAAAA,GAAG,CAACU,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAqCuB,SAArC;AACAlC,IAAAA,OAAO,CAAC4B,IAAR,CAAa,QAAb;AACD;;AAED,SAAO;AAAE1B,IAAAA,aAAF;AAAiBE,IAAAA,OAAjB;AAA0BU,IAAAA,WAA1B;AAAuCkB,IAAAA;AAAvC,GAAP;AACD","sourcesContent":["import { useState, useEffect } from 'react';\n\nimport api from '../../api';\nimport history from '../../history';\n\nexport default function useAuth() {\n  const [authenticated, setAuthenticated] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`;\n      setAuthenticated(true);\n    }\n\n    setLoading(false);\n  }, []);\n  \n  async function handleLogin(dados) {\n\n    const userName = dados.login\n    const password = dados.password\n    const response = \"\";\n\n    try {\n      const response = await api.post('/users/login', { userName, password });\n      \n      const nome = response.data.name;\n\n      localStorage.setItem('name', JSON.stringify(response.data.name));\n      localStorage.setItem('id', JSON.stringify(response.data.id));\n      // api.defaults.headers.Authorization = `Bearer ${token}`;\n\n      alert(localStorage.getItem('id'));\n\n      setAuthenticated(true);\n      history.push({\n        pathname: '/Users',\n        state: nome,\n      });\n    } catch (err) {\n      alert(\"Erro no login! verifique seus dados \");\n    } \n    \n  }\n\n  function handleLogout() {\n    setAuthenticated(false);\n    localStorage.removeItem('token');\n    api.defaults.headers.Authorization = undefined;\n    history.push('/login');\n  }\n  \n  return { authenticated, loading, handleLogin, handleLogout };\n}"]},"metadata":{},"sourceType":"module"}